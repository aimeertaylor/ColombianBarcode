---
title: Preliminary exploration of P. falciparum relatedness on the Colombian coast
header-includes:
output: pdf_document
---

# Notes to self
Read semi-aquatic mammal paper

### To reproduce all, run 
1. DataFormat.R
2. Geo_dist_sites_colombia.R
2. Generate_Fst_Colombia.R
3. Generate_Result_Colombia.R
3. child scripts for separate analyses
4. this script for all analyses combined

# To-do list

- Incorporate maps here
- Consider modelling as a mixture distribution Beta distributions (one for each of the n choose 2 site comparisons). The number of parameters would be 
    - Beta distributions: 2 shape parameters * choose(number sites,2)
    - Mixing: 1 vector length choose(number sites,2)
- Usefuly phrase: "Adequate isolation to prevent" repopulation [Blanton2018]"
- use std devidation of distance measures as did Ollie watson: 
- check out Lee 2003 (cited in Waples2019) very simple but elegant test of relatedness under null that they are not.  


## Association of genetic signal to human mobility
  - GIS analysis (cost surface creation)
  - Add travel time to regression analyses (sent message to Marine Traffic and to Harvard CGA).
  - Consider random design regression analysis to account for uncertainty in travel time 

## Is genetic connectivity between Buenaventura and Tamaco the result of single or multiple travel events?

Following discussions with Dan 8th Aug 2017, extreme scenarios inc.

1. single travel event single clone 
1. single travel event with multiple clones 
2. multiple travel single clone
3. multiple travel events differnt clones

In terms of malaria control, we care about single versus multiple travel events. If multiple different haplotypes underpin comparisons that are IBD, we can refute the null hypothesis that there was a single travel event with a single clone (calculation of LD might come into this). We can then compare the number of unique haplotypes in source populations. Perhaps still worth considering signal between Buenaventura and Tumaco wrt expected breakdown expected over time (based on regression).

Reason for no-longer pursuing STRUCTURE on the viterbi output: In terms of the viterbi output, the haplotype from a single travel event could give rise to multiple independent lineages of breakpoints. In which case, muliple clusters inferred using STRUCTURE run on the viterbi output would not refute the the null hypothesis that there was a single travel event. Even if there were a single lineage, STRUCTURE may incorrectly identify nested clusters as independent (i.e. would consider a cluster whose breakpoints are compatible with mieotic errosion of a parent cluster to be independent of said parent cluster). 

Following convo with Caroline on 8th. 
Could use an epi explanation to refute the null. For example, how big would the R0 need to be for the situation to occur. She also drew stripes based on just scalar expectations: repeat and make plot wider. That should suffice


### Error log
On Friday 1st of Dec, I  realised the lack of correlation between IBS and IBD was mainly due to not transposing the results of apply() and then also due to re-ordering SNPs for hmmIBD but not in the SNP data used to calculate FST and IBS. This resulted in meaningless FST and IBS estimates, which did not agree with previously FST published results nor correlate with IBD. The IBD analyses were unchanged. With a well chosen cut-off, IBS now performs as well as IBD in the Colombian setting. 

### For skype with Diego: 
- Why "As expected, the lowest differentiation between the provinces was found between Valle-Nariño (FST = 0.023) while the highest was for Cauca–Chocó (FST = 0.117) (Additional file 4)."
- Confirm missing '--'
- Apologise for not seeing the lon/lat
- How to consolidate story if reporting FST?
- What is the probability of being asymptomatic and therefore missing nodes? 

\pagebreak

```{r setup, include = FALSE}
#===============================================================================
# Default chunk options
#===============================================================================
rm(list = ls())
knitr::opts_chunk$set(echo=FALSE, warning=FALSE, message=FALSE, include=FALSE, cache=TRUE, 
                      cache.comments = FALSE, fig.pos = 'H', fig.width = 7, dev = 'png', dpi = 300)
```

```{r, child = 'child_data_summary.Rmd'}
```

\pagebreak

```{r, child = 'child_FST.Rmd'}
```

\pagebreak

```{r, child = 'child_IBD_IBS.Rmd'}
```

```{r, child = 'child_Buenaventura_Tamaco_graph.Rmd'}
```

```{r, child = 'child_haps.Rmd'}
```

```{r, child = 'child_IBD_segments.Rmd'}
```

\pagebreak

```{r, child = 'child_regression.Rmd'}
```

