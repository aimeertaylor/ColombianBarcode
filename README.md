# ColombianBarcode

To reproduce the work in the manuscript entitled "Identity-by-descent relatedness estimates with uncertainty characterise departure from isolation-by-distance between **Plasmodium falciparum** populations on the Colombian-Pacific coast" using processed data (SNPData.RData and hmmInput.txt generated by DataFormat.R; and LonLat.RData, geo_dist_info_states.RData, and geo_dist_info_cities.RData generated by Generate_geo_dist_info.R) complete the following four steps.

1. Set the working directory to ColombianBarcode/Code

2. Run Generate_mles_CIs.R (SLOW, outputs mles_CIs.RData)

3. Run Format_mle_df.R (outputs All_results.RData)

4. Run in no particular order

- Generate_transportdistances_city.R (outputs All_W_results_c.RData)
- Generate_proportions.R (outputs proportions_time.RData and proportions_geo.RData)
- Generate_proportions_sensitivity.R (outputs proportions_sensitivities.RData)

5. Run in no particular order

- Plot_proportions_distances.R (outputs Proportions_and_W_distance.pdf)
- Plot_proportions_sensitivity.R (outputs Proportions_sensitivity.pdf)
- Plot_graph_components.R (outputs All_CCs.pdf, Graphs_timespace.pdf and Graphs.pdf)
- Knit to PDF Data_summary.Rmd (outputs Data_summary.pdf)

Notes to self: 
- !.gitignore "../GISData/CP_coast.shp" and re-add Plot_network.R (outputs Colombia_network%d.png and Colombia_Map.png) 
- ensure ignored files are synced across work and personal laptops and finalise .gitignore
- check work laptop notes on Effect of COI and transmission intensity (duplicate analysis?)
- make sure ms title cited above is up-to-date 

